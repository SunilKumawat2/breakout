"use client";
import React, { useEffect, useState, useRef } from "react";
import InnerPageBanner from "@/components/InnerPageBanner";
import Image from "next/image";
import enc from "@/images/enc.svg";
import mBox from "@/images/m-box.png";
import HmTextSec from "@/components/home/HmTextSec";
import icon1 from "@/images/icon1.svg";
import icon2 from "@/images/icon2.svg";
import icon3 from "@/images/icon3.svg";
import icon4 from "@/images/icon4.svg";
import illus3 from "@/images/illus3.svg";
import hmIllus from "@/images/bottom-illus.svg";
import LogoSec from "@/components/LogoSec";
import EscapeRoomCard from "@/components/EscapeRoomCard";
import CounterBox from "@/components/CounterBox";
import VisitLocations from "@/components/VisitLocations";
import PeakExpSec from "@/components/PeakExpSec";
import BlogSlider from "@/components/BlogSlider";
import HomeContact from "@/components/home/HomeContact";
import locIcon from "@/images/loc-icon.svg";
import ReserveASlot from "@/components/ReserveASlot";
import fdImg1 from "@/images/fd-img1.png";
import Link from "next/link";
import wh from "@/images/wh.svg";
import locPlace from "@/images/loc-place.svg";
import BirthdayBanner from "@/components/BirthdayBanner";
import bdayIllus from "@/images/bday-illus.svg";
import PartyGetInTouch from "@/components/PartyGetInTouch";

import whicon from "@/images/wh-icon.svg";
import phicon from "@/images/phone.svg";
import mailicon from "@/images/mail-icon.svg";

import bdayImg1 from "@/images/kid1.jpg";
import bdayImg2 from "@/images/kid2.jpg";
import bdayImg3 from "@/images/kid3.jpg";
import bdayImg4 from "@/images/kid4.jpg";
import bdayImg5 from "@/images/kid5.jpg";
import bdayImg6 from "@/images/kid6.jpg";
import bdayImg7 from "@/images/kid7.jpg";
import partyillus from "@/images/party-illus.svg";
import BirthdayGetInTouch from "@/components/BirthdayGetInTouch";
import PartySlider from "@/components/PartySlider";
import ReadyToGoPlans from "@/components/ReadyToGoPlans";
import Videotestimonials from "@/components/Videotestimonials";
import FaqSection from "@/components/FaqSection";

import nightIllus from "@/images/night-illus.svg";

import bdayBanner from "@/images/kid-banner.jpg";

import theme1 from "@/images/theme1.jpg";
import theme2 from "@/images/theme2.jpg";
import theme3 from "@/images/theme3.jpg";
import theme4 from "@/images/theme4.jpg";

import Packages from "@/components/Packages";

import PartyExpertCon from "@/components/PartyExpertCon";

import movieIllus from "@/images/movie-illus.svg";
import OurLocationSec from "@/components/OurLocationSec";
import coupleIllus from "@/images/couple-illus.svg";
import loveIllus from "@/images/love-illus.svg";
import { useParams } from "next/navigation";
import api from "@/helpers/api";
import TrustedSection from "@/components/TrustedSection";
import GReviewSlider from "@/components/GReviewSlider";
import PhotographicStyledImage from "@/components/PhotographicStyledImage";
import bachelorIllus from "@/images/bachelor-illus.png";
import farewellIllus from "@/images/farewell_illus.png";
import WordByWordAnimation from "@/helpers/WordByWordAnimation";

const page = () => {
  const [party, setParty] = useState(null);
  useEffect(() => {
    const fetchParty = async () => {
      const response = await api.get(`party/farewell-archive`);
      setParty(response.data.data);
    };
    fetchParty();
  }, []);

  // --- REWRITE: Fix word by word animation for heading ---

  // Use a more robust approach with React state and effect, and avoid direct DOM manipulation.
  // We'll use a state to hold the current phrase and the current word index, and animate via setTimeout.

  // Extract phrases from the <span>...</span> in the heading itself, split by '|', and animate them

  // Get the heading template from API if available, else fallback to default
  const headingTemplate =
    party?.countersection?.heading ||
    "Make ‘your love’ feel<br /><span>special! | Farewell | One-of-a-kind? | Memories | Memories Last Forever</span>";

  // const animatedHeading = WordByWordAnimation(headingTemplate);

  return (
    <>
      {party && party?.bannersection && (
        <InnerPageBanner banner={party?.bannersection} bdayInner={true} />
      )}

      <div className="black-gr-div">
        {party && party?.countersection && (
          <section className="section-padding pb-0">
            <div className="container">
              <div className="row">
                <div className="col-lg-12 text-center">
                  {/* <h3
                    className="sec-head"
                    style={{ minHeight: 60 }}
                    dangerouslySetInnerHTML={{ __html: animatedHeading }}
                  /> */}
                  {/* <h3 className="sec-head" style={{ minHeight: 60 }}>
                    {animatedHeading}
                  </h3> */}
                  <WordByWordAnimation headingTemplate={headingTemplate} />
                </div>
              </div>
            </div>
          </section>
        )}
        {party && party?.countersection && (
          <HmTextSec text={party?.countersection?.content} />
        )}
        {party && party?.countersection && (
          <div className="container">
            <div className="bday-text-wrap">
              <p
                className="underline-big-text"
                dangerouslySetInnerHTML={{
                  __html: party?.countersection?.note,
                }}
              ></p>
            </div>
          </div>
        )}

        {party && party?.countersection && (
          <TrustedSection data={party?.countersection} removeHeading={true} />
        )}

        {/* <section className="section-padding bday-count-sec pb-0">
          <div className="container">
            <div className="row row-gap-25">
              {[...Array(4)].map((_, index) => (
                <div className="col-lg-3 col-6" key={index}>
                  <CounterBox key={index} bday={true} />
                </div>
              ))}
            </div>
          </div>
        </section> */}

        {party && party?.imagecardsection && (
          <section className="section-padding bday-sec">
            <div className="container">
              <div className="row">
                <div className="col-lg-12 text-center">
                  <h3
                    className="sec-head medium sm-head"
                    dangerouslySetInnerHTML={{
                      __html:
                        party?.imagecardsection?.heading || "Is it party for a",
                    }}
                  />
                </div>
              </div>
              <div className="row mt-5 row-gap-25 justify-content-center">
                <div className="col-lg-8 col-12">
                  <div className="row row-gap-25">
                    {party?.imagecardsection?.images &&
                      party?.imagecardsection?.images?.length > 0 &&
                      party?.imagecardsection?.images?.map((item, index) => (
                        <div className="col-lg-6 col-12" key={index}>
                          <div className="location-card">
                            <div className="location-card-img">
                              {item.image && (
                                <Image
                                  src={item.image}
                                  width={500}
                                  height={500}
                                  alt={item.heading}
                                />
                              )}
                            </div>
                            <div className="location-card-content">
                              <h3
                                dangerouslySetInnerHTML={{
                                  __html: item.heading,
                                }}
                              />
                            </div>
                          </div>
                        </div>
                      ))}
                  </div>
                </div>
              </div>
            </div>
          </section>
        )}

        <Image src={farewellIllus} className={"w-100 h-auto"} alt="bday" />
      </div>

      <div className="black-gr-div">
        {party && party?.partyinclusions && (
          <section className="section-padding bday-sec">
            <div className="container">
              <div className="row">
                <div className="col-lg-12 text-center">
                  <h3
                    className="sec-head medium sm-head"
                    dangerouslySetInnerHTML={{
                      __html:
                        party?.partyinclusions?.heading ||
                        "Your Party <span>Inclusions</span>",
                    }}
                  />
                </div>
              </div>
              <div className="row mt-5 row-gap-25">
                {party?.partyinclusions?.images &&
                  party?.partyinclusions?.images?.length > 0 &&
                  party?.partyinclusions?.images?.map((bd, index) => (
                    <div className="col-lg-4 col-12" key={index}>
                      <div className="location-card">
                        <div className="location-card-img">
                          {bd.image && (
                            <Image
                              src={bd.image}
                              width={700}
                              height={700}
                              alt={bd.heading}
                            />
                          )}
                        </div>
                        <div className="location-card-content">
                          <h3
                            dangerouslySetInnerHTML={{ __html: bd.heading }}
                          />
                        </div>
                      </div>
                    </div>
                  ))}
              </div>
            </div>
          </section>
        )}

        <section className="section-padding bday-sec d-none">
          <div className="container">
            <div className="row">
              <div className="col-lg-12 text-center">
                <h3
                  className="sec-head medium sm-head"
                  dangerouslySetInnerHTML={{
                    __html: "Add a <span>Theme Décor</span>",
                  }}
                />
              </div>
            </div>
            <div className="row mt-5 row-gap-25">
              {[...Array(4)].map((_, index) => (
                <div className="col-lg-3 col-12" key={index}>
                  <div className="location-card">
                    <div className="location-card-img">
                      {/* {bd.image && (
                            <Image
                              src={bd.image}
                              width={50}
                              height={50}
                              alt={bd.heading}
                            />
                          )} */}
                    </div>
                    <div className="location-card-content">
                      <h3 dangerouslySetInnerHTML={{ __html: "Classic" }} />
                    </div>
                  </div>
                </div>
              ))}
            </div>
          </div>
        </section>

        {party &&
          party?.packagesection &&
          party?.packagesection?.pricing?.columns?.length > 0 && (
            <Packages packages={party?.packagesection} />
          )}

        {party && party?.googlereviews && (
          <GReviewSlider commonStars={false} data={party?.googlereviews} />
        )}

        <Image src={bdayIllus} alt="illus3" className="illus-3 w-100 h-auto" />
      </div>
      <div className="black-gr-div">
        <PartyExpertCon />
        {party && party?.slidersection && (
          <ReadyToGoPlans data={party?.slidersection} />
        )}
        {party && party?.imagesection && (
          <>
            <section className="section-padding">
              <div className="container">
                <div className="row">
                  <div className="col-lg-12 text-center">
                    <h3
                      className="sec-head sm-head medium"
                      dangerouslySetInnerHTML={{
                        __html: "<span>Capturing</span> Happiness",
                      }}
                    ></h3>
                  </div>
                </div>
                <div className="row">
                  <div className="photographic-styled-image-container">
                    {party?.imagesection?.image1 && (
                      <PhotographicStyledImage
                        image={party?.imagesection?.image1}
                      />
                    )}
                    {party?.imagesection?.image2 && (
                      <PhotographicStyledImage
                        image={party?.imagesection?.image2}
                      />
                    )}
                    {party?.imagesection?.image3 && (
                      <PhotographicStyledImage
                        image={party?.imagesection?.image3}
                      />
                    )}
                  </div>
                </div>
              </div>
            </section>
          </>
        )}
        {party && party?.videotestimonials && (
          <Videotestimonials data={party?.videotestimonials} />
        )}
        <Image src={loveIllus} className={"w-100 h-auto mt-5"} alt="bday" />
      </div>
      <div className="black-gr-div">
        {/* {JSON.stringify(party?.slug)} */}
        <OurLocationSec title="About Our <span>Our Location</span>" />
        {party && party?.faqsection && <FaqSection data={party?.faqsection} />}
        <BlogSlider />
        <LogoSec />
        {party && party?.footersection && (
          <PartyGetInTouch
            img={nightIllus}
            noTextBottom={true}
            privacyLine={true}
            data={party?.footersection}
          />
        )}
        {/* {party && party?.footersection && (
          <BirthdayGetInTouch
            img={nightIllus}
            noTextBottom={true}
            textData={party?.footersection}
          />
        )} */}
      </div>
    </>
  );
};

export default page;
